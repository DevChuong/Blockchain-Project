<!DOCTYPE HTML>
<html>
	<head>
		<title>Add records blockchain project</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<meta name="description" content="" />
		<meta name="keywords" content="" />
		<link rel="stylesheet" href="assets/css/main.css" />
		<script src="./node_modules/web3/dist/web3.min.js"></script>
		<link rel="stylesheet" href="./cssfiles/addrecord.css">
	</head>
	<body class="is-preload">

		<!-- Header -->
			<header id="header">
				<a class="logo" href="index.html">Block chain project</a>
				<div style="background-color: #00ff00; color: black;">
					<input type="text" id="Account_Address" disabled="" size="73">
				</div>

				<nav>
					<a href="#menu">Menu</a>
				</nav>
			</header>

			<!-- Nav -->
				<nav id="menu">
					<ul class="links">
						<li><a href="index.html">Home</a></li>
						<li><a href="Authorise.html">Authorize</a></li>
						<li><a href="Unauthorize.html">Unauthorize</a></li>
						<li><a href="Add_Records.html">Add records</a></li>
						<li><a href="Look_Up.html">Look up info</a></li>
						<li><a href="Sign_Verify.html">Sign/Verify</a></li>
						<li><a href="Look_Up_Records.html">Employee records</a></li>
					</ul>
				</nav>

		<!-- Banner -->
			<section id="banner">
				<div class="inner">
					<h1>Block chain in health care</h1>
					<p>This website is used for authorizing/unauthorizing, adding records and looking up information from the system<br />
					it also used for signing and verifying message.</p>
				</div>
				<video autoplay loop muted playsinline src="images/hospital.mp4"></video>
			</section>

		<!-- phần front end  -->
			<section class="wrapper">
				<div class="inner">
					<header class="special">
						<h2>Add records</h2>
						<p>Make sure you are using the right authorized account!.</p>
					</header>
					<h3>Employee information</h3>


			<!-- Add record form -->
					<form method="post" action="#">
						<div class="row gtr-uniform">
							<div class="col-6 col-12-xsmall">
								<input disabled="" readonly="" type="text" name="hos_add" id="hos_add" value="" placeholder="Hospital address" />
							</div>
							<div class="col-6 col-12-xsmall">
								<input type="text" name="emp_add" id="emp_add" value="" placeholder="Employee Address" />
							</div>
							<div class="col-6 col-12-xsmall">
								<input type="text" name="emp_ID" id="emp_ID" value="" placeholder="Employee ID" />
							</div>
							<div class="col-6 col-12-xsmall">
								<input type="text" name="emp_name" id="emp_name" value="" placeholder="Employee name" />
							</div>
							<div class="col-6 col-12-xsmall">
								<input type="text" name="hos_name" id="trainee_hos_name" value="" placeholder=" Trainee Hospital Name" />
							</div>
							<div class="col-6 col-12-xsmall">
								<input type="text" name="id_record" id="id_record" value="" placeholder="ID  record" />
							</div>
							<div class="col-6 col-12-xsmall">
								<input type="text" name="record_hashing" id="record_hashing" value="" placeholder="Record Hashing" />
							</div>
							<div class="col-6 col-12-xsmall">
								<input type="text" name="certificate" id="certificate" value="" placeholder="Certificate" />
							</div>
							<div class="col-6 col-12-xsmall">
								<input type="text" name="signature" id="signature" value="" placeholder="Signature" />
							</div>
							<div class="col-6 col-12-xsmall">
								<a href="#" id="add_rec" class="button primary">Submit</a>
							</div>

						</div>
					</form>

			<!-- Confirm table -->
				<div class="confirm_table">
					<div class="row gtr-uniform">
							<div class="col-6 col-12-xsmall">
								<input disabled="" readonly="" type="text" name="hos_add" id="hos_add" value="" placeholder="Hospital address" />
							</div>
							<div class="col-6 col-12-xsmall">
								<input type="text" name="emp_add" id="emp_add" value="" placeholder="Employee Address" />
							</div>
							<div class="col-6 col-12-xsmall">
								<input type="text" name="hos_name" id="trainee_hos_name" value="" placeholder=" Trainee Hospital Name" />
							</div>

							<div class="col-6 col-12-xsmall">
								<input type="text" name="emp_ID" id="emp_ID" value="" placeholder="Employee ID" />
							</div>
							<div class="col-6 col-12-xsmall">
								<input type="text" name="emp_name" id="emp_name" value="" placeholder="Employee name" />
							</div>
							<div class="col-6 col-12-xsmall">
								<input type="text" name="id_record" id="id_record" value="" placeholder="ID  record" />
							</div>
							<div class="col-6 col-12-xsmall">
								<input type="text" name="record_hashing" id="record_hashing" value="" placeholder="Record Hashing" />
							</div>
							<div class="col-6 col-12-xsmall">
								<input type="text" name="certificate" id="certificate" value="" placeholder="Certificate" />
							</div>
							<div class="col-6 col-12-xsmall">
								<input type="text" name="signature" id="signature" value="" placeholder="Signature" />
							</div>

					</div>

				</div>

			<!-- phần frontend gọi api -->
			<br>
			<br>
			<br>
			<div class="api_section">
				<button id="api">Gọi api</button>
				<div id="outputAPI"></div>
			</div>




			</section>

		<!-- Footer -->
			<footer id="footer">
				<div class="inner">
					<div class="content">
						<section>
							<h3>About the project</h3>
							<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum..</p>
						</section>
						<section>
							<h4>Functions</h4>
							<ul class="alt">
								<li><a href="index.html">Home</a></li>
								<li><a href="auth_all.html">Authorize</a></li>
								<li><a href="unauth.html">Unauthorize</a></li>
								<li><a href="lookuppage.html">Look up info</a></li>
								<li><a href="signverifymessage.html">Sign/Verify</a></li>
								<li><a href="lookuprecords.html">Employee records</a></li>
							</ul>
						</section>
						<section>
							<h4>Team social media</h4>
							<ul class="plain">
								<li><a href="#"><i class="icon fa-twitter">&nbsp;</i>Twitter</a></li>
								<li><a href="#"><i class="icon fa-facebook">&nbsp;</i>Facebook</a></li>
								<li><a href="#"><i class="icon fa-instagram">&nbsp;</i>Instagram</a></li>
								<li><a href="#"><i class="icon fa-github">&nbsp;</i>Github</a></li>
							</ul>
						</section>
					</div>
					<div class="copyright">
						&copy; This is the blockchain project website.
					</div>
				</div>
			</footer>

		<!-- Scripts -->
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/browser.min.js"></script>
			<script src="assets/js/breakpoints.min.js"></script>
			<script src="assets/js/util.js"></script>
			<script src="assets/js/main.js"></script>

		<!-- Phần Add record  -->
			<script>
				$(document).ready(function(){
					$("#add_rec").click(function(){
						try {
							var HospitalAddress = $("#hos_add").val();
							var TraineeAddress = $("#emp_add").val();
							var TraineeID = $("#emp_ID").val();
							var TraineeName = $("#emp_name").val();
							var TraineeHospitalName = $("#trainee_hos_name").val();
							var IDRecord = $("#id_record").val();
							var RecordHashing = $("#record_hashing").val();
							var Certificate = $("#certificate").val();
							var Signature = $("#signature").val();

							contract.Add_Records(HospitalAddress,TraineeAddress,TraineeID,TraineeName,TraineeHospitalName,IDRecord,RecordHashing,Certificate,Signature,{from : account, gas: 3000000});
							alert("The record has been added !");
						} catch{
							if(account != HospitalAddress) {
								alert("Error: the account does not match !");
							}else {
								alert("Please check your information again !");
							}


						}
					});
				});

				function cache_clear() {
					window.location.reload(true);
				}


			</script>

			<script>
				$(function(){
					$("#Account_Address").val( "Index: " + index +" Account address: " + account);
					$("#hos_add").val(account);
				});
			</script>

		<!-- PHẦN GỌI API  -->

		<script>
			document.getElementById("api").addEventListener("click",getValue)
			function getValue() {
			    const proxyurl = "https://cors-anywhere.herokuapp.com/";
	    	    const url = "http://fad141e0.ngrok.io/resources/books/all";
				fetch(proxyurl + url)
				.then(function(response){
					return response.json();
				})
				.then(function(data) {
					let result = ` <h2> User Info From books... </h2>`;
					data.forEach((user) => {
		            const { id, name } = user
		            result +=
		            `<div>
		                <h5> User ID: ${id} </h5>
		                <ul class="w3-ul">
		                    <li> User Name : ${name}</li>
		                </ul>
		            </div>`;

					})
					document.getElementById("outputAPI").innerHTML = result;

				});
			}
		</script>



		<!-- web3 -->
			<script>
				if(typeof web3 !== 'undefined'){
					web3 = new Web3(web3.currentProvider);
				} else {
					web3 = new Web3(new Web3.providers.HttpProvider("HTTP://127.0.0.1:8545"));
				}

				var index = 2;
				web3.eth.defaultAccount =  web3.eth.accounts[index];

				var account = web3.eth.defaultAccount

				var contract = web3.eth.contract([
	{
		"constant": false,
		"inputs": [
			{
				"name": "_HospitalAddress",
				"type": "address"
			},
			{
				"name": "_TraineeAddress",
				"type": "address"
			},
			{
				"name": "_TraineeID",
				"type": "uint256"
			},
			{
				"name": "_TraineeName",
				"type": "string"
			},
			{
				"name": "_TrHospitalName",
				"type": "string"
			}
		],
		"name": "Add_Employees",
		"outputs": [],
		"payable": false,
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"constant": false,
		"inputs": [
			{
				"name": "_HospitalAddress",
				"type": "address"
			},
			{
				"name": "_TraineeAddress",
				"type": "address"
			},
			{
				"name": "_TraineeID",
				"type": "uint256"
			},
			{
				"name": "_TraineeName",
				"type": "string"
			},
			{
				"name": "_TrHospitaName",
				"type": "string"
			},
			{
				"name": "_ID_Record",
				"type": "uint256"
			},
			{
				"name": "_Record_Hashing",
				"type": "string"
			},
			{
				"name": "_TraineeCertificate",
				"type": "string"
			},
			{
				"name": "_Signature",
				"type": "string"
			}
		],
		"name": "Add_Records",
		"outputs": [],
		"payable": false,
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"constant": false,
		"inputs": [
			{
				"name": "_HospitalAddress",
				"type": "address"
			},
			{
				"name": "_HospitalID",
				"type": "uint256"
			},
			{
				"name": "_HospitalName",
				"type": "string"
			}
		],
		"name": "Authorise_Hospital",
		"outputs": [],
		"payable": false,
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"constant": false,
		"inputs": [
			{
				"name": "_HospitalAddress",
				"type": "address"
			},
			{
				"name": "_TraineeAddress",
				"type": "address"
			},
			{
				"name": "_TraineeID",
				"type": "uint256"
			}
		],
		"name": "deleteEmployee",
		"outputs": [],
		"payable": false,
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"constant": false,
		"inputs": [
			{
				"name": "_HospitalAddress",
				"type": "address"
			},
			{
				"name": "_HospitalID",
				"type": "uint256"
			}
		],
		"name": "deleteHospital",
		"outputs": [],
		"payable": false,
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"constant": false,
		"inputs": [
			{
				"name": "_TraineeAddress",
				"type": "address"
			}
		],
		"name": "getListOfTraineesRecords",
		"outputs": [],
		"payable": false,
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"inputs": [],
		"payable": false,
		"stateMutability": "nonpayable",
		"type": "constructor"
	},
	{
		"anonymous": false,
		"inputs": [
			{
				"indexed": false,
				"name": "_HospitalAddress",
				"type": "address"
			},
			{
				"indexed": false,
				"name": "_HospitalID",
				"type": "uint256"
			}
		],
		"name": "delete_Hospital",
		"type": "event"
	},
	{
		"anonymous": false,
		"inputs": [
			{
				"indexed": false,
				"name": "_HospitalAddress",
				"type": "address"
			},
			{
				"indexed": false,
				"name": "_TraineeAddress",
				"type": "address"
			},
			{
				"indexed": false,
				"name": "_TraineeID",
				"type": "uint256"
			},
			{
				"indexed": false,
				"name": "_TraineeName",
				"type": "string"
			},
			{
				"indexed": false,
				"name": "_TrHospitaName",
				"type": "string"
			},
			{
				"indexed": false,
				"name": "_ID_Record",
				"type": "uint256"
			},
			{
				"indexed": false,
				"name": "_Record_Hashing",
				"type": "string"
			},
			{
				"indexed": false,
				"name": "_TraineeCertificate",
				"type": "string"
			},
			{
				"indexed": false,
				"name": "_Signature",
				"type": "string"
			}
		],
		"name": "add_Records",
		"type": "event"
	},
	{
		"constant": true,
		"inputs": [],
		"name": "_NationalAuthority",
		"outputs": [
			{
				"name": "",
				"type": "address"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	},
	{
		"constant": true,
		"inputs": [],
		"name": "getListOfHospitals",
		"outputs": [
			{
				"components": [
					{
						"name": "_HospitalAddress",
						"type": "address"
					},
					{
						"name": "_HospitalID",
						"type": "uint256"
					},
					{
						"name": "_HospitalName",
						"type": "string"
					}
				],
				"name": "",
				"type": "tuple[]"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	},
	{
		"constant": true,
		"inputs": [],
		"name": "getListOfTrainees",
		"outputs": [
			{
				"components": [
					{
						"name": "_TraineeAddress",
						"type": "address"
					},
					{
						"name": "_TraineeID",
						"type": "uint256"
					},
					{
						"name": "_TraineeName",
						"type": "string"
					},
					{
						"name": "_TrHospitaName",
						"type": "string"
					},
					{
						"name": "_ID_Record",
						"type": "uint256"
					},
					{
						"name": "_Record_Hashing",
						"type": "string"
					},
					{
						"name": "_TraineeCertificate",
						"type": "string"
					},
					{
						"name": "_Signature",
						"type": "string"
					}
				],
				"name": "",
				"type": "tuple[]"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	},
	{
		"constant": true,
		"inputs": [
			{
				"name": "",
				"type": "uint256"
			}
		],
		"name": "OfficialEmployees",
		"outputs": [
			{
				"name": "",
				"type": "address"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	},
	{
		"constant": true,
		"inputs": [],
		"name": "Records",
		"outputs": [
			{
				"components": [
					{
						"name": "_TraineeAddress",
						"type": "address"
					},
					{
						"name": "_TraineeID",
						"type": "uint256"
					},
					{
						"name": "_TraineeName",
						"type": "string"
					},
					{
						"name": "_TrHospitaName",
						"type": "string"
					},
					{
						"name": "_ID_Record",
						"type": "uint256"
					},
					{
						"name": "_Record_Hashing",
						"type": "string"
					},
					{
						"name": "_TraineeCertificate",
						"type": "string"
					},
					{
						"name": "_Signature",
						"type": "string"
					}
				],
				"name": "",
				"type": "tuple[]"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	},
	{
		"constant": true,
		"inputs": [
			{
				"name": "hash",
				"type": "bytes32"
			},
			{
				"name": "sig",
				"type": "bytes"
			}
		],
		"name": "recoverSigner",
		"outputs": [
			{
				"name": "",
				"type": "address"
			}
		],
		"payable": false,
		"stateMutability": "pure",
		"type": "function"
	},
	{
		"constant": true,
		"inputs": [
			{
				"name": "_HospitalAddress",
				"type": "address"
			}
		],
		"name": "See_Authorised_Hospital",
		"outputs": [
			{
				"name": "",
				"type": "address"
			},
			{
				"name": "",
				"type": "uint256"
			},
			{
				"name": "",
				"type": "string"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	},
	{
		"constant": true,
		"inputs": [
			{
				"name": "_TraineeAddress",
				"type": "address"
			}
		],
		"name": "See_Employee_Info",
		"outputs": [
			{
				"name": "",
				"type": "uint256"
			},
			{
				"name": "",
				"type": "string"
			},
			{
				"name": "",
				"type": "string"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	},
	{
		"constant": true,
		"inputs": [
			{
				"name": "_TraineeAddress",
				"type": "address"
			}
		],
		"name": "See_Employee_Latest_Records",
		"outputs": [
			{
				"name": "",
				"type": "uint256"
			},
			{
				"name": "",
				"type": "string"
			},
			{
				"name": "",
				"type": "string"
			},
			{
				"name": "",
				"type": "uint256"
			},
			{
				"name": "",
				"type": "string"
			},
			{
				"name": "",
				"type": "string"
			},
			{
				"name": "",
				"type": "string"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	}
]).at('0x039b94acf82b88b67fc3aa9e62c6445be9a05b4a');

			</script>




	</body>
</html>
