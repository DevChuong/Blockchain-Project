<!DOCTYPE HTML>
<html>
	<head>
		<title>Authorize blockchain project</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<meta name="description" content="" />
		<meta name="keywords" content="" />
		<link rel="stylesheet" href="assets/css/main.css" />
		<script src="./node_modules/web3/dist/web3.min.js"></script>
	</head>
	<body class="is-preload">

		<!-- Header -->
			<header id="header">
				<a class="logo" href="index.html">Block chain project</a>

				<div>
					<input type="text" id="Account_Address" disabled="" size="90">
				</div>

				<nav>
					<a href="#menu">Menu</a>
				</nav>

			</header>

			<!-- Nav -->
				<nav id="menu">
					<ul class="links">
						<li><a href="index.html">Home</a></li>
						<li><a href="Authorise.html">Authorize</a></li>
						<li><a href="Unauthorize.html">Unauthorize</a></li>
						<li><a href="Add_Records.html">Add records</a></li>
						<li><a href="Look_Up.html">Look up info</a></li>
						<li><a href="Sign_Verify.html">Sign/Verify</a></li>
						<li><a href="Look_Up_Records.html">Employee records</a></li>
					</ul>
				</nav>

		<!-- Banner -->
			<section id="banner">
				<div class="inner">
					<h1>Block chain in health care</h1>
					<p>This website is used for authorizing/unauthorizing, adding records and looking up information from the system<br />
					it also used for signing and verifying message.</p>
				</div>
				<video autoplay loop muted playsinline src="images/hospital.mp4"></video>
			</section>

		<!-- Highlights -->
			<section class="wrapper">
				<div class="inner">
					<header class="special">
						<h2>Authorize employees/hospitals</h2>
						<p>Make sure you are using the right authorized account!.</p>
					</header>

					<!-- <div class="highlights"> -->

						<!-- chọn trước nè -->

						<div class="col-12">
							<select name="select_auth" id="category">
								<option value="">- Select the one you want to authorize -</option>
								<option  value="tr">Trainees</option>
								<option  value="hpt">Hospitals</option>
							</select>



							<!-- Form trainee -->
							<div id = "form_trainee" class="col-12">
								<br>
								<h3>Authorize employee</h3>
					      <form method="post" action="#">
					        <div class="row gtr-uniform">
					          <div class="col-6 col-12-xsmall">
					            <input type="text" name="auth_emp_name" id="auth_emp_name" value="" placeholder="Trainee Name" required />
					          </div>
								<div class="col-6 col-12-xsmall">
					            <input type="text" name="auth_emp_ID" id="auth_emp_ID" value="" placeholder="Trainee ID" required />
					          </div>
								<div class="col-6 col-12-xsmall">
					            <input type="text" name="auth_emp_add" id="auth_emp_add" value="" placeholder="Trainee Address" required/>
					          </div>
								<div class="col-6 col-12-xsmall">
					            <input type="text" name="auth_emp_hos" id="auth_emp_hos" value="" placeholder="Trainee Hospital" required/>
					          </div>
										<div class="col-6 col-12-xsmall">
											Hospital Address that wants to add employee:
											<input  type="text" name="auth_emp_hos_addr" id="auth_emp_hos_addr" value="" placeholder="Hospital Address" required/ disabled="">
										</div>

										<div class="col-6 col-12-xsmall">
											<br>
												<a href="#" id="employee_submit" class="button primary">Submit</a>
										</div>
								</div>
							</div>


							<!-- Form hospital -->
							<div id = "form_hospital" class="col-12">
								<br>
								<h4>Authorize hospital</h4>

								<form id = "form_hospital" method="post" action="#">
									<div class="row gtr-uniform">
										<div class="col-6 col-12-xsmall">
											<input type="text" name="auth_hos_name" id="auth_hos_name" value="" placeholder="Hospital Name" required />
											<!-- last -->
										</div>
										<div class="col-6 col-12-xsmall">
											<input type="text" name="auth_hos_ID" id="auth_hos_ID" value="" placeholder="Hospital ID" required/>
											<!-- Odd -->
										</div>
										<div class="col-6 col-12-xsmall">
											<input type="text" name="auth_hos_add" id="auth_hos_add" value="" placeholder="Hospital Address" required/>
											<!-- normal -->
										</div>
										<div class="col-6 col-12-xsmall">
												<a href="#" id="hospital_submit" class="button primary">Submit</a>
										</div>
									</div>
							</div>

			</section>





		<!-- Footer -->
			<footer id="footer">
				<div class="inner">
					<div class="content">
						<section>
							<h3>About the project</h3>
							<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum..</p>
						</section>
						<section>
							<h4>Functions</h4>
							<ul class="alt">
								<li><a href="index.html">Home</a></li>
								<li><a href="unauth.html">Unauthorize</a></li>
								<li><a href="add_rec.html">Add records</a></li>
								<li><a href="lookuppage.html">Look up info</a></li>
								<li><a href="signverifymessage.html">Sign/Verify</a></li>
								<li><a href="lookuprecords.html">Employee records</a></li>
							</ul>
						</section>
						<section>
							<h4>Team social media</h4>
							<ul class="plain">
								<li><a href="#"><i class="icon fa-twitter">&nbsp;</i>Twitter</a></li>
								<li><a href="#"><i class="icon fa-facebook">&nbsp;</i>Facebook</a></li>
								<li><a href="#"><i class="icon fa-instagram">&nbsp;</i>Instagram</a></li>
								<li><a href="#"><i class="icon fa-github">&nbsp;</i>Github</a></li>
							</ul>
						</section>
					</div>
					<div class="copyright">
						&copy; This is the blockchain project website.
					</div>
				</div>
			</footer>

		<!-- Scripts -->
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/browser.min.js"></script>
			<script src="assets/js/breakpoints.min.js"></script>
			<script src="assets/js/util.js"></script>
			<script src="assets/js/main.js"></script>
			<script>
				$(function(){
					$("#Account_Address").val( "Index: " + index +" Account address: " + account);
					$("#auth_emp_hos_addr").val(account);
				});
			</script>

			<script>
				$(document).ready(function(){
				$('select[name="select_auth"]').change(function(){
				if ($(this).val()=="tr") {
				$('#form_trainee').show(500);
				} else {
				$('#form_trainee').hide(500);
				}
				});
				$('select[name="select_auth"]').change(function(){
				if ($(this).val()=="hpt") {
				$('#form_hospital').show(500);
				} else {
				$('#form_hospital').hide(500);
				}
				});
				});
			</script>
			<!-- Auth emp -->

			<script type="text/javascript">
	  		    $(document).ready(function(){
			        $("#employee_submit").click(function(){
			          try{
			          var TraineeName = $("#auth_emp_name:text").val();
			          var TraineeID = $("#auth_emp_ID:text").val();
			          var TraineeHospitalName = $("#auth_emp_name").val();
			          var HospitalAddress = $("#auth_emp_hos_addr").val();
			          var TraineeAddress = $("#auth_emp_add:text").val();
			          //console.log(HospitalAddress, TraineeAddress , TraineeID, TraineeName, TraineeHospitalName);
			          contract.Add_Employees(HospitalAddress, TraineeAddress , TraineeID, TraineeName, TraineeHospitalName, { from: account, gas: 3000000 });
			          setInterval(function() {
			            cache_clear()
			          });
			          alert("Added");
			        }catch{
			          if(account != HospitalAddress)
			          {
			            alert("The Hospital Address and your account address isn't match !");
			            alert("Please check the information again !");
			          }
			          else {
			            alert("Error : Please check if the hospital address is authorised or the trainee address has been already authorised !");
			          }

				        }
				      });
				    });

				        function cache_clear() {
				         window.location.reload(true);
				        };
	   	 	</script>


			<!-- Auth hos -->
			<script type="text/javascript">
					$(document).ready(function(){
						$("#hospital_submit").click(function(){
							try{
								var HospitalName = $("#auth_hos_name").val();
								 contract.Authorise_Hospital($("#auth_hos_add").val(), $("#auth_hos_ID").val(), HospitalName, { from: account, gas: 3000000 });
								 setInterval(function() {
									 cache_clear()
								 });
								 // Give conditions if succeed, load the success deploy page. If fail, alert failure !
								 alert("Added");
							}
							catch(err){
							if(account != web3.eth.accounts[0]){
									alert("This account is not the National Authority account !");
								} else {
									alert("The Hospital Address has been already stored in the BlockChain !");
								}

							}

						});


						function cache_clear() {
						 window.location.reload(true);
						};
							});

			</script>

			<!-- Web3 -->
			<script>
				if(typeof web3 !== 'undefined'){
					web3 = new Web3(web3.currentProvider);
				} else {
					web3 = new Web3(new Web3.providers.HttpProvider("HTTP://127.0.0.1:8545"));
				}

				var index = 1;
				web3.eth.defaultAccount =  web3.eth.accounts[index];

				var account = web3.eth.defaultAccount

				var contract = web3.eth.contract([
						{
							"constant": false,
							"inputs": [
								{
									"name": "_HospitalAddress",
									"type": "address"
								},
								{
									"name": "_TraineeAddress",
									"type": "address"
								},
								{
									"name": "_TraineeID",
									"type": "uint256"
								},
								{
									"name": "_TraineeName",
									"type": "string"
								},
								{
									"name": "_TrHospitalName",
									"type": "string"
								}
							],
							"name": "Add_Employees",
							"outputs": [],
							"payable": false,
							"stateMutability": "nonpayable",
							"type": "function"
						},
						{
							"constant": false,
							"inputs": [
								{
									"name": "_HospitalAddress",
									"type": "address"
								},
								{
									"name": "_TraineeAddress",
									"type": "address"
								},
								{
									"name": "_TraineeID",
									"type": "uint256"
								},
								{
									"name": "_TraineeName",
									"type": "string"
								},
								{
									"name": "_TrHospitaName",
									"type": "string"
								},
								{
									"name": "_Category",
									"type": "string"
								},
								{
									"name": "_TraineeCertificate",
									"type": "string"
								},
								{
									"name": "_Signature",
									"type": "string"
								}
							],
							"name": "Add_Records",
							"outputs": [],
							"payable": false,
							"stateMutability": "nonpayable",
							"type": "function"
						},
						{
							"constant": false,
							"inputs": [
								{
									"name": "_HospitalAddress",
									"type": "address"
								},
								{
									"name": "_HospitalID",
									"type": "uint256"
								},
								{
									"name": "_HospitalName",
									"type": "string"
								}
							],
							"name": "Authorise_Hospital",
							"outputs": [],
							"payable": false,
							"stateMutability": "nonpayable",
							"type": "function"
						},
						{
							"constant": false,
							"inputs": [
								{
									"name": "_HospitalAddress",
									"type": "address"
								},
								{
									"name": "_TraineeAddress",
									"type": "address"
								},
								{
									"name": "_TraineeID",
									"type": "uint256"
								}
							],
							"name": "deleteEmployee",
							"outputs": [],
							"payable": false,
							"stateMutability": "nonpayable",
							"type": "function"
						},
						{
							"constant": false,
							"inputs": [
								{
									"name": "_HospitalAddress",
									"type": "address"
								},
								{
									"name": "_HospitalID",
									"type": "uint256"
								}
							],
							"name": "deleteHospital",
							"outputs": [],
							"payable": false,
							"stateMutability": "nonpayable",
							"type": "function"
						},
						{
							"constant": false,
							"inputs": [
								{
									"name": "_TraineeAddress",
									"type": "address"
								}
							],
							"name": "getListOfTraineesRecords",
							"outputs": [],
							"payable": false,
							"stateMutability": "nonpayable",
							"type": "function"
						},
						{
							"inputs": [],
							"payable": false,
							"stateMutability": "nonpayable",
							"type": "constructor"
						},
						{
							"anonymous": false,
							"inputs": [
								{
									"indexed": false,
									"name": "_HospitalAddress",
									"type": "address"
								},
								{
									"indexed": false,
									"name": "_HospitalID",
									"type": "uint256"
								}
							],
							"name": "delete_Hospital",
							"type": "event"
						},
						{
							"anonymous": false,
							"inputs": [
								{
									"indexed": false,
									"name": "_HospitalAddress",
									"type": "address"
								},
								{
									"indexed": false,
									"name": "_TraineeAddress",
									"type": "address"
								},
								{
									"indexed": false,
									"name": "_TraineeID",
									"type": "uint256"
								},
								{
									"indexed": false,
									"name": "_TraineeName",
									"type": "string"
								},
								{
									"indexed": false,
									"name": "_TrHospitaName",
									"type": "string"
								},
								{
									"indexed": false,
									"name": "_Category",
									"type": "string"
								},
								{
									"indexed": false,
									"name": "_TraineeCertificate",
									"type": "string"
								},
								{
									"indexed": false,
									"name": "_Signature",
									"type": "string"
								}
							],
							"name": "add_Records",
							"type": "event"
						},
						{
							"constant": true,
							"inputs": [],
							"name": "_NationalAuthority",
							"outputs": [
								{
									"name": "",
									"type": "address"
								}
							],
							"payable": false,
							"stateMutability": "view",
							"type": "function"
						},
						{
							"constant": true,
							"inputs": [],
							"name": "getListOfHospitals",
							"outputs": [
								{
									"components": [
										{
											"name": "_HospitalAddress",
											"type": "address"
										},
										{
											"name": "_HospitalID",
											"type": "uint256"
										},
										{
											"name": "_HospitalName",
											"type": "string"
										}
									],
									"name": "",
									"type": "tuple[]"
								}
							],
							"payable": false,
							"stateMutability": "view",
							"type": "function"
						},
						{
							"constant": true,
							"inputs": [],
							"name": "getListOfTrainees",
							"outputs": [
								{
									"components": [
										{
											"name": "_TraineeAddress",
											"type": "address"
										},
										{
											"name": "_TraineeID",
											"type": "uint256"
										},
										{
											"name": "_TraineeName",
											"type": "string"
										},
										{
											"name": "_TrHospitaName",
											"type": "string"
										},
										{
											"name": "_Category",
											"type": "string"
										},
										{
											"name": "_TraineeCertificate",
											"type": "string"
										},
										{
											"name": "_Signature",
											"type": "string"
										}
									],
									"name": "",
									"type": "tuple[]"
								}
							],
							"payable": false,
							"stateMutability": "view",
							"type": "function"
						},
						{
							"constant": true,
							"inputs": [
								{
									"name": "",
									"type": "uint256"
								}
							],
							"name": "OfficialEmployees",
							"outputs": [
								{
									"name": "",
									"type": "address"
								}
							],
							"payable": false,
							"stateMutability": "view",
							"type": "function"
						},
						{
							"constant": true,
							"inputs": [],
							"name": "Records",
							"outputs": [
								{
									"components": [
										{
											"name": "_TraineeAddress",
											"type": "address"
										},
										{
											"name": "_TraineeID",
											"type": "uint256"
										},
										{
											"name": "_TraineeName",
											"type": "string"
										},
										{
											"name": "_TrHospitaName",
											"type": "string"
										},
										{
											"name": "_Category",
											"type": "string"
										},
										{
											"name": "_TraineeCertificate",
											"type": "string"
										},
										{
											"name": "_Signature",
											"type": "string"
										}
									],
									"name": "",
									"type": "tuple[]"
								}
							],
							"payable": false,
							"stateMutability": "view",
							"type": "function"
						},
						{
							"constant": true,
							"inputs": [
								{
									"name": "hash",
									"type": "bytes32"
								},
								{
									"name": "sig",
									"type": "bytes"
								}
							],
							"name": "recoverSigner",
							"outputs": [
								{
									"name": "",
									"type": "address"
								}
							],
							"payable": false,
							"stateMutability": "pure",
							"type": "function"
						},
						{
							"constant": true,
							"inputs": [
								{
									"name": "_HospitalAddress",
									"type": "address"
								}
							],
							"name": "See_Authorised_Hospital",
							"outputs": [
								{
									"name": "",
									"type": "address"
								},
								{
									"name": "",
									"type": "uint256"
								},
								{
									"name": "",
									"type": "string"
								}
							],
							"payable": false,
							"stateMutability": "view",
							"type": "function"
						},
						{
							"constant": true,
							"inputs": [
								{
									"name": "_TraineeAddress",
									"type": "address"
								}
							],
							"name": "See_Employee_Info",
							"outputs": [
								{
									"name": "",
									"type": "uint256"
								},
								{
									"name": "",
									"type": "string"
								},
								{
									"name": "",
									"type": "string"
								}
							],
							"payable": false,
							"stateMutability": "view",
							"type": "function"
						},
						{
							"constant": true,
							"inputs": [
								{
									"name": "_TraineeAddress",
									"type": "address"
								}
							],
							"name": "See_Employee_Latest_Records",
							"outputs": [
								{
									"name": "",
									"type": "uint256"
								},
								{
									"name": "",
									"type": "string"
								},
								{
									"name": "",
									"type": "string"
								},
								{
									"name": "",
									"type": "string"
								},
								{
									"name": "",
									"type": "string"
								},
								{
									"name": "",
									"type": "string"
								}
							],
							"payable": false,
							"stateMutability": "view",
							"type": "function"
						}
					]).at('0x0dde98481d145c110c499532f6ea4c08e73ee3c1');

			</script>
	</body>
</html>
